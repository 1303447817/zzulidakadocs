# 概述
> 此脚本基于Python3.7及以上版本编写
>
> 建议有一定Python基础及网络基础的同学阅读学习。

## 运行原理
### 登录模块🙄
使用fiddler配置局域网代理，给手机抓包。  

在手机上运行i轻工大APP获取打卡的URL链接。  

发现需要使用郑州轻工业大学统一认证服务进行登录。  

使用selenium模块+Chrome+Chromedriver 

打开Chrome浏览器（Linux服务器使用无gui模式运行）并前往打卡URL，使用selenium模拟点击输入账户和密码完成登录。  

### 数据分析模块🤨
使用fiddler继续抓包，完成一次人工打卡。

通过对所抓数据包分析，发现两个重要数据包。

一个可以从学校服务器获取部分个人信息，例如所在学院和班级。

另一个是完整的data包，向指定服务器发送打卡信息，并获取到了指定的服务器地址。
### 数据处理并提交🤔
我们所做的就是利用用户提供的个人信息和从学校服务器获取到的信息合并为完整的data数据包  

并以json的格式储存，调整为和正常打卡时发送的数据包格式一致。
### header处理😯
正确的header信息可以保证数据可以正确提交。  

我们模仿了正常浏览器的header  

并使用selenium提取了cookie

带上已经处理过的data数据包

写出了完整的header
### 数据提交😪
使用post的方式向指定服务器提交数据，并记录返回值的http状态码以判断是否成功提交。
### 其他部分🥱
使用返回的http状态码判断是否打卡成功，并使用mail函数发送邮件。

## 我们遇到的困难😡
> 作为非计算机及软院的同学，我们两人在程序开发期间遇到了很多问题，现列出问题及解决思路供大家学习。

### 打卡思路选择

最开始我们计划全程使用selenium模拟点击

可是因为网页由Vue构建

selenium定位元素太过于麻烦

我们改用了手动发送数据包的方式

### 数据包发送后返回值502

我们解决这个问题花了近两天时间

首先是保证我们模拟的header和正常打卡的header格式一样

由于没有过硬的Python功底

字符串处理很耗费时间

我们在解决header的问题后

还是返回502

后来发现是数据包编码问题

我们修改了数据包的编码终于发送成功，返回值200

